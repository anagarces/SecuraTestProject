<div
  class="min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 bg-gradient-to-br from-indigo-50 to-gray-200 dark:from-gray-900 dark:to-gray-800"
>
  <div
    class="max-w-md w-full p-10 bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 relative overflow-hidden"
  >
    <!-- Franja de color degradado (Integración Visual) -->
    <div
      class="absolute top-0 left-0 right-0 h-2 bg-gradient-to-r from-pink-500 to-indigo-600 rounded-t-2xl"
    ></div>

    <div class="text-center pt-4">
      <h2 class="mt-3 text-4xl font-extrabold text-gray-900 dark:text-white">
        Únete a <span class="text-pink-600 dark:text-pink-400">SecuraTest</span>
      </h2>
      <p class="mt-2 text-md text-gray-600 dark:text-gray-400">
        Da el salto a la seguridad: regístrate y convierte tu conocimiento en el
        mejor cortafuegos.
      </p>
    </div>

    <form
      [formGroup]="registerForm"
      (ngSubmit)="onSubmit()"
      class="mt-8 space-y-6"
    >
      <div class="rounded-md shadow-sm space-y-5">
        <!-- Nombre -->
        <div>
          <label
            for="nombre"
            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
            >Nombre</label
          >
          <input
            id="nombre"
            formControlName="nombre"
            type="text"
            placeholder="Tu nombre completo"
            class="appearance-none relative block w-full px-4 py-3 border border-gray-300 dark:border-gray-600 placeholder-gray-500 text-gray-900 dark:text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-pink-500 dark:bg-gray-700 transition-shadow shadow-inner"
          />
          <!-- Errores de validación del cliente (Nombre) -->
          <div *ngIf="f['nombre'].touched && f['nombre'].errors" class="mt-1">
            <small
              *ngIf="f['nombre'].errors['required']"
              class="text-xs font-medium text-red-500"
            >
              El nombre es obligatorio.
            </small>
            <small
              *ngIf="f['nombre'].errors['pattern']"
              class="text-xs font-medium text-red-500"
            >
              El nombre solo debe contener letras y espacios.
            </small>
          </div>
        </div>

        <!-- Email -->
        <div>
          <label
            for="email"
            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
            >Email</label
          >
          <input
            id="email"
            formControlName="email"
            type="email"
            placeholder="correo@empresa.com"
            class="appearance-none relative block w-full px-4 py-3 border border-gray-300 dark:border-gray-600 placeholder-gray-500 text-gray-900 dark:text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-pink-500 dark:bg-gray-700 transition-shadow shadow-inner"
          />
          <!-- Errores del backend -->
          <div *ngIf="backendErrors.email" class="mt-1">
            <small class="text-xs font-medium text-red-500">{{
              backendErrors.email
            }}</small>
          </div>
          <!-- Errores del cliente -->
          <div *ngIf="f['email'].touched && f['email'].errors" class="mt-1">
            <small
              *ngIf="f['email'].errors['required']"
              class="text-xs font-medium text-red-500"
            >
              El email es obligatorio.
            </small>
            <small
              *ngIf="f['email'].errors['email']"
              class="text-xs font-medium text-red-500"
            >
              El formato del email no es válido.
            </small>
          </div>
        </div>

        <!-- Contraseña -->
        <div>
          <label
            for="password"
            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
            >Contraseña</label
          >
          <input
            id="password"
            formControlName="password"
            type="password"
            placeholder="Mín. 8 chars, Mayús, Minús, Núm, Símbolo"
            class="appearance-none relative block w-full px-4 py-3 border border-gray-300 dark:border-gray-600 placeholder-gray-500 text-gray-900 dark:text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-pink-500 dark:bg-gray-700 transition-shadow shadow-inner"
          />
          <!-- Errores del backend -->
          <div *ngIf="backendErrors.password" class="mt-1">
            <small class="text-xs font-medium text-red-500">{{
              backendErrors.password
            }}</small>
          </div>
          <!-- Errores del cliente (Contraseña) -->
          <div
            *ngIf="f['password'].touched && f['password'].errors"
            class="mt-1"
          >
            <small
              *ngIf="f['password'].errors['required']"
              class="text-xs font-medium text-red-500"
            >
              La contraseña es obligatoria.
            </small>
            <small
              *ngIf="
                f['password'].errors['minlength'] ||
                f['password'].errors['pattern']
              "
              class="text-xs font-medium text-red-500"
            >
              La contraseña debe tener al menos 8 caracteres y contener
              Mayúsculas, Minúsculas, números y símbolos.
            </small>
          </div>
        </div>

        <!-- Confirmar Contraseña (NUEVO CAMPO) -->
        <div>
          <label
            for="confirmPassword"
            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
            >Confirmar Contraseña</label
          >
          <input
            id="confirmPassword"
            formControlName="confirmPassword"
            type="password"
            placeholder="Repite tu contraseña"
            class="appearance-none relative block w-full px-4 py-3 border border-gray-300 dark:border-gray-600 placeholder-gray-500 text-gray-900 dark:text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-pink-500 dark:bg-gray-700 transition-shadow shadow-inner"
          />
          <!-- Errores del cliente (Confirmación) -->
          <div
            *ngIf="f['confirmPassword'].touched && f['confirmPassword'].errors"
            class="mt-1"
          >
            <small
              *ngIf="f['confirmPassword'].errors['required']"
              class="text-xs font-medium text-red-500"
            >
              La confirmación es obligatoria.
            </small>
            <!-- Este error se establece a nivel de formGroup -->
            <small
              *ngIf="registerForm.errors?.['mustMatch'] && f['confirmPassword'].errors?.['mustMatch']"
              class="text-xs font-medium text-red-500"
            >
              Las contraseñas no coinciden.
            </small>
          </div>
        </div>
      </div>

      <!-- Botón de Registro con Degradado -->
      <div>
        <button
          type="submit"
          [disabled]="registerForm.invalid || loading"
          class="group relative w-full flex justify-center items-center gap-2 py-3.5 px-4 border border-transparent text-lg font-bold rounded-xl text-white bg-gradient-to-r from-pink-500 to-indigo-600 hover:from-pink-600 hover:to-indigo-700 focus:outline-none focus:ring-4 focus:ring-offset-2 focus:ring-pink-500 disabled:opacity-50 disabled:cursor-not-allowed shadow-xl shadow-pink-500/50 transition-all transform hover:scale-[1.01]"
        >
          <!-- Texto normal -->
          <span *ngIf="!loading">Registrar</span>

          <!-- Loader -->
          <span *ngIf="loading" class="loader"></span>
        </button>
      </div>

      <!-- Mensaje de éxito -->
      <div
        *ngIf="message"
        class="text-center p-3 rounded-lg bg-green-50 text-green-700 border border-green-200"
      >
        <p class="font-medium">{{ message }}</p>
      </div>

      <!-- Enlace a Iniciar Sesión -->
      <div
        class="text-center text-sm font-medium pt-4 border-t border-gray-100 dark:border-gray-700"
      >
        <p class="text-gray-600 dark:text-gray-400">
          ¿Ya tienes cuenta?
          <a
            routerLink="/login"
            class="font-bold text-pink-600 dark:text-pink-400 hover:text-pink-500 dark:hover:text-pink-300 transition-colors"
          >
            Iniciar sesión aquí
          </a>
        </p>
      </div>
    </form>
  </div>
</div>
