<div class="container mx-auto px-4 sm:px-6 lg:px-8 py-10">
  <!-- Botón Volver (Mejorado) -->
  <div class="mb-6 max-w-4xl mx-auto">
    <button
      (click)="volver()"
      class="inline-flex items-center px-4 py-2 text-sm font-medium rounded-full border border-gray-300 shadow-sm transition-colors bg-white hover:bg-gray-50 text-gray-700 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600"
    >
      <svg
        class="w-4 h-4 mr-2"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M10 19l-7-7m0 0l7-7m-7 7h18"
        />
      </svg>
      Volver al Catálogo
    </button>
  </div>

  <ng-container *ngIf="contenido$ | async as contenido; else loadingOrError">
    <article
      *ngIf="contenido"
      class="max-w-4xl mx-auto bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-6 md:p-10 border border-gray-100 dark:border-gray-700"
    >
      <!-- METADATOS: Tema y Dificultad (Badges) -->
      <div class="flex items-center space-x-3 mb-4">
        <!-- Tema -->
        <span
          class="text-sm font-medium text-indigo-600 dark:text-indigo-400 bg-indigo-50 dark:bg-indigo-900/10 px-3 py-1 rounded-full border border-indigo-200 dark:border-indigo-800"
        >
          Tema: {{ contenido.tema || "General" | uppercase }}
        </span>

        <!-- Dificultad -->
        <span
          class="rounded-full px-3 py-1 text-xs font-semibold"
          [ngClass]="{
            'bg-green-100 text-green-700':
              contenido.nivelDificultad === 'Básico',
            'bg-yellow-100 text-yellow-700':
              contenido.nivelDificultad === 'Intermedio',
            'bg-red-100 text-red-700': contenido.nivelDificultad === 'Avanzado',
            'bg-gray-100 text-gray-700': !contenido.nivelDificultad
          }"
        >
          Dificultad: {{ contenido.nivelDificultad || "N/A" }}
        </span>
      </div>

      <!-- TÍTULO -->
      <h1
        class="mb-6 text-4xl font-extrabold tracking-tight text-gray-900 dark:text-white lg:text-5xl border-b pb-4 dark:border-gray-700"
      >
        {{ contenido.titulo }}
      </h1>

      <!-- CUERPO DEL CONTENIDO -->
      <div
        class="prose lg:prose-xl dark:prose-invert max-w-none text-gray-700 dark:text-gray-300"
      >
        <!-- Mantengo la clase original por si tiene estilos CSS específicos -->
        <p class="texto-con-formato">{{ contenido.cuerpo }}</p>
      </div>
    </article>
  </ng-container>

  <ng-template #loadingOrError>
    <!-- Template de Error y Carga -->
    <div
      class="max-w-4xl mx-auto py-20 bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-6 md:p-10 border border-gray-100 dark:border-gray-700"
    >
      <div *ngIf="errorOcurrido; else loading" class="text-center">
        <svg
          class="mx-auto h-12 w-12 text-red-500"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
          />
        </svg>
        <h2 class="mt-2 text-2xl font-bold text-red-600 dark:text-red-500">
          Error al cargar
        </h2>
        <p class="mt-1 text-gray-500 dark:text-gray-400">
          No se pudo cargar el contenido. Verifique la conexión o el ID del
          artículo.
        </p>
      </div>
      <ng-template #loading>
        <div class="text-center">
          <div
            class="animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-600 mx-auto mb-3"
          ></div>
          <p class="text-gray-500 dark:text-gray-400">Cargando contenido...</p>
        </div>
      </ng-template>
    </div>
  </ng-template>
</div>
